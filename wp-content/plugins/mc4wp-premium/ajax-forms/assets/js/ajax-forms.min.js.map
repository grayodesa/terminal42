{"version":3,"sources":["ajax-forms/assets/js/ajax-forms.js"],"names":["require","undefined","e","t","n","r","s","o","u","a","i","f","Error","code","l","exports","call","length",1,"module","submit","form","start","setResponse","loader","fire","busy","request","XMLHttpRequest","onreadystatechange","this","readyState","clean","status","response","JSON","parse","responseText","error","console","log","generalErrorMessage","process","open","config","ajax_url","setRequestHeader","send","getSerializedData","forms","trigger","message","errors","data","getData","hide_fields","element","querySelector","style","display","redirect_to","window","location","href","reset","event","stop","Loader","formElement","button","originalButton","cloneNode","loadingText","getAttribute","value","styles","getComputedStyle","width","loadingCharacter","loadingInterval","setInterval","opacity","clearInterval","mc4wp","mc4wp_ajax_vars","loading_character","error_text","on","indexOf","returnValue","preventDefault"],"mappings":"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","file":"ajax-forms/assets/js/ajax-forms.min.js","sourcesContent":["(function () { var require = undefined; var define = undefined; (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n'use strict';\n\n// TODO: Allow choosing loading animation (animated button / opacity)\nvar forms = window.mc4wp.forms;\nvar busy = false;\nvar config = mc4wp_ajax_vars || {};\nvar loadingCharacter = config.loading_character || '\\u00B7';\nvar generalErrorMessage = '<div class=\"mc4wp-alert mc4wp-error\"><p>'+ config.error_text + '</p></div>';\n\nforms.on('submit', function( form, event ) {\n\n\t// does this form have AJAX enabled?\n\t// @todo move to data attribute?\n\tif( form.element.getAttribute('class').indexOf('mc4wp-ajax') < 0 ) {\n\t\treturn;\n\t}\n\n\ttry{\n\t\tsubmit(form);\n\t} catch(e) {\n\t\tconsole.error(e);\n\t\treturn true;\n\t}\n\n\tevent.returnValue = false;\n\tevent.preventDefault();\n\treturn false;\n});\n\nfunction submit( form ) {\n\n\tvar loader = new Loader(form.element);\n\n\tfunction start() {\n\n\t\t// Clear possible errors from previous submit\n\t\tform.setResponse('');\n\t\tloader.start();\n\t\tfire();\n\t}\n\n\tfunction fire() {\n\t\t// prepare request\n\t\tbusy = true;\n\t\tvar request = new XMLHttpRequest();\n\t\trequest.onreadystatechange = function() {\n\t\t\t// are we done?\n\t\t\tif (this.readyState == 4) {\n\t\t\t\tclean();\n\n\t\t\t\tif (this.status >= 200 && this.status < 400) {\n\t\t\t\t\t// Request success! :-)\n\t\t\t\t\ttry {\n\t\t\t\t\t\tvar response = JSON.parse(this.responseText);\n\t\t\t\t\t} catch(error) {\n\t\t\t\t\t\tconsole.log( 'MailChimp for WordPress: failed to parse AJAX response.\\n\\nError: \"' + error + '\"' );\n\n\t\t\t\t\t\t// Not good..\n\t\t\t\t\t\tform.setResponse(generalErrorMessage);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tprocess(response);\n\t\t\t\t} else {\n\t\t\t\t\t// Error :(\n\t\t\t\t\tconsole.log(this.responseText);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\trequest.open('POST', config.ajax_url, true);\n\t\trequest.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\n\t\trequest.send(form.getSerializedData());\n\t\trequest = null;\n\t}\n\n\tfunction process( response ) {\n\n\t\tforms.trigger('submitted', [form]);\n\n\t\tif( response.error ) {\n\t\t\tform.setResponse(response.error.message);\n\t\t\tforms.trigger('error', [form, response.error.errors]);\n\t\t} else {\n\t\t\tvar data  = form.getData();\n\n\t\t\t// Show response message\n\t\t\tform.setResponse(response.data.message);\n\n\t\t\tif( response.data.hide_fields ) {\n\t\t\t\tform.element.querySelector('.mc4wp-form-fields').style.display = 'none';\n\t\t\t}\n\n\t\t\tif( response.data.redirect_to ) {\n\t\t\t\twindow.location.href = response.data.redirect_to;\n\t\t\t}\n\n\t\t\t// finally, reset form element\n\t\t\tform.element.reset();\n\n\t\t\t// trigger events\n\t\t\tforms.trigger('success', [form, data]);\n\t\t\tforms.trigger( response.data.event, [form, data ]);\n\t\t}\n\t}\n\n\tfunction clean() {\n\t\tloader.stop();\n\t\tbusy = false;\n\t}\n\n\t// let's do this!\n\tif( ! busy ) {\n\t\tstart();\n\t}\n}\n\nfunction Loader(formElement) {\n\n\tvar button, originalButton, loadingInterval;\n\n\tfunction start() {\n\t\tbutton = formElement.querySelector('input[type=\"submit\"]');\n\t\tif( button ) {\n\n\t\t\toriginalButton = button.cloneNode(true);\n\n\t\t\t// loading text\n\t\t\tvar loadingText = button.getAttribute('data-loading-text');\n\t\t\tif( loadingText ) {\n\t\t\t\tbutton.value = loadingText;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Show AJAX loader\n\t\t\tvar styles = window.getComputedStyle( button );\n\t\t\tbutton.style.width = styles.width;\n\t\t\tbutton.value = loadingCharacter;\n\t\t\tloadingInterval = window.setInterval( function() {\n\n\t\t\t\t// count chars, start over at 5\n\t\t\t\t// @todo start over once at 60% of button width\n\t\t\t\tif( button.value.length >= 5 ) {\n\t\t\t\t\tbutton.value = loadingCharacter;\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tbutton.value += ' ' + loadingCharacter;\n\t\t\t}, 500 );\n\t\t} else {\n\t\t\tformElement.style.opacity = '0.5';\n\t\t}\n\t}\n\n\tfunction stop() {\n\t\tif( button ) {\n\t\t\tbutton.style.width = originalButton.style.width;\n\t\t\tbutton.value = originalButton.value;\n\t\t\twindow.clearInterval(loadingInterval);\n\t\t} else {\n\t\t\tformElement.style.opacity = '';\n\t\t}\n\n\t}\n\n\treturn {\n\t\tstart: start,\n\t\tstop: stop\n\t}\n}\n\n},{}]},{},[1]);\n })();"],"sourceRoot":"/source/"}