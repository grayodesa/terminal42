jQuery(document).ready(function(a){var b,c,d=wc_appointment_form_params.appointment_duration,e=1>d?1:d,f=e,g={init:function(){a("body").on("change","#wc_appointments_field_staff",this.date_picker_init),a(".wc-appointments-date-picker legend small.wc-appointments-date-picker-choose-date").show(),a(".wc-appointments-date-picker").each(function(){var b=a(this).closest("form"),c=b.find(".picker"),d=a(this).closest("fieldset");g.date_picker_init(c),a(".wc-appointments-date-picker-date-fields",d).hide(),a(".wc-appointments-date-picker-choose-date",d).hide()})},select_date_trigger:function(d,e){var g=a(this).closest("fieldset"),h=(a(this).closest("form"),d.split("-")),i=new Date(d),j=i.getFullYear(),k=i.getMonth(),l=i.getDate();b=new Date(j,k,l),c=new Date(j,k,l-1+parseInt(f)),g.find("input.appointment_to_date_year").val(""),g.find("input.appointment_to_date_month").val(""),g.find("input.appointment_to_date_day").val(""),g.find("input.appointment_date_year").val(h[0]),g.find("input.appointment_date_month").val(h[1]),g.find("input.appointment_date_day").val(h[2]).change(),g.triggerHandler("date-selected",d)},date_picker_init:function(b){var c=a(b);c=a(b).is(".picker")?a(b):a(this).closest("form").find(".picker:eq(0)"),c.empty().removeClass("hasDatepicker").datepicker({dateFormat:a.datepicker.ISO_8601,showWeek:!1,showOn:!1,beforeShowDay:g.is_appointable,onSelect:g.select_date_trigger,minDate:c.data("min_date"),maxDate:c.data("max_date"),defaultDate:c.data("default_date"),numberOfMonths:1,showButtonPanel:!1,showOtherMonths:!1,selectOtherMonths:!1,closeText:wc_appointment_form_params.closeText,currentText:wc_appointment_form_params.currentText,prevText:wc_appointment_form_params.prevText,nextText:wc_appointment_form_params.nextText,monthNames:wc_appointment_form_params.monthNames,monthNamesShort:wc_appointment_form_params.monthNamesShort,dayNames:wc_appointment_form_params.dayNames,dayNamesMin:wc_appointment_form_params.dayNamesShort,firstDay:wc_appointment_form_params.firstDay,gotoCurrent:!0}),a(".ui-datepicker-current-day").removeClass("ui-datepicker-current-day");var d=c.closest("form"),e=parseInt(d.find("input.appointment_date_year").val(),10),f=parseInt(d.find("input.appointment_date_month").val(),10),h=parseInt(d.find("input.appointment_date_day").val(),10);if(e&&f&&h){var i=new Date(e,f-1,h);c.datepicker("setDate",i)}},is_appointable:function(d){var f=a(this).closest("form"),g=a(this).data("availability"),h=a(this).data("default-availability"),i=a(this).data("fully-scheduled-days"),j=a(this).data("partially-scheduled-days"),k=a(this).data("remaining-scheduled-days"),l=wc_appointment_form_params.availability_span,m="",n=0,o="";n=f.find("select#wc_appointments_field_staff").val()>0?f.find("select#wc_appointments_field_staff").val():0;var p=new Date(d),q=p.getFullYear(),r=p.getMonth()+1,s=p.getDate(),t=p.getDay(),u=a.datepicker.iso8601Week(p);if(i[q+"-"+r+"-"+s]&&(i[q+"-"+r+"-"+s][0]||i[q+"-"+r+"-"+s][n]))return[!1,"fully_scheduled",wc_appointment_form_params.i18n_date_fully_scheduled];if(""+q+r+s<wc_appointment_form_params.current_time)return[!1,"not_appointable",wc_appointment_form_params.i18n_date_unavailable];j&&j[q+"-"+r+"-"+s]&&((j[q+"-"+r+"-"+s][0]||j[q+"-"+r+"-"+s][n])&&(m+="partial_scheduled "),k[q+"-"+r+"-"+s][0]?m=m+"remaining_scheduled_"+k[q+"-"+r+"-"+s][0]+" ":k[q+"-"+r+"-"+s][n]&&(m=m+"remaining_scheduled_"+k[q+"-"+r+"-"+s][n]+" ")),d>=b&&c>=d&&(m="ui-datepicker-selected-day"),"start"==l&&(e=1);for(var v=h,w=0;e>w&&(p=new Date(d),p.setDate(p.getDate()+w),q=p.getFullYear(),r=p.getMonth()+1,month_zero=("0"+(p.getMonth()+1)).slice(-2),s=p.getDate(),day_zero=("0"+p.getDate()).slice(-2),t=p.getDay(),u=a.datepicker.iso8601Week(p),day_format=q+"-"+month_zero+"-"+day_zero,v=h,0===t&&(t=7),a.each(g[n],function(a,b){var c=b[0],d=b[1];try{switch(c){case"months":if("undefined"!=typeof d[r])return v=d[r],!1;break;case"weeks":if("undefined"!=typeof d[u])return v=d[u],!1;break;case"days":if("undefined"!=typeof d[t])return v=d[t],!1;break;case"custom":if("undefined"!=typeof d[q][r][s])return v=d[q][r][s],!1;break;case"time_date":if(d.date===day_format)return v=!0,!1}}catch(e){}return!0}),i[q+"-"+r+"-"+s]&&(i[q+"-"+r+"-"+s][0]||i[q+"-"+r+"-"+s][n])&&(v=!1),v);w++);return v?(o=m.indexOf("partial_scheduled")>-1?wc_appointment_form_params.i18n_date_partially_scheduled:wc_appointment_form_params.i18n_date_available,[v,m+" appointable",o]):[v,m+" not_appointable",wc_appointment_form_params.i18n_date_unavailable]}};g.init()});